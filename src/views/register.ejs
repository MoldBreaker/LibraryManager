<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒêƒÉng k√Ω</title>
</head>
<body>
    <h2>Form ƒêƒÉng K√Ω</h2>
    <form id="registerForm">
        <input type="text" id="Username" placeholder="T√™n ƒëƒÉng nh·∫≠p" required><br>
        <input type="password" id="password" placeholder="M·∫≠t kh·∫©u" required><br>
        <input type="email" id="email" placeholder="Email" required><br>
        <input type="text" id="cardNumber" placeholder="S·ªë th·∫ª" required><br>
        
        <label for="roleId">Ch·ªçn vai tr√≤:</label>
        <select id="roleId" required>
            <option value="" disabled selected>Ch·ªçn vai tr√≤</option>
            <option value="1">Admin</option>
            <option value="2">User</option>
            <option value="3">Moderator</option>
        </select>
        <br>

        <button type="submit">ƒêƒÉng K√Ω</button>
    </form>
    
    <p id="message"></p>

    <script>
        document.getElementById("registerForm").addEventListener("submit", async function(event) {
            event.preventDefault();

            const username = document.getElementById("Username").value;
            const password = document.getElementById("password").value;
            const email = document.getElementById("email").value;
            const cardNumber = document.getElementById("cardNumber").value;
            const roleId = document.getElementById("roleId").value;

            // Ki·ªÉm tra roleId ƒë√£ ƒë∆∞·ª£c ch·ªçn hay ch∆∞a
            if (!roleId) {
                document.getElementById("message").textContent = "Vui l√≤ng ch·ªçn vai tr√≤!";
                return;
            }

            console.log("üìå RoleId ƒë∆∞·ª£c g·ª≠i:", roleId); // Ki·ªÉm tra tr√™n console

            try {
                const response = await fetch("http://localhost:3000/register", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        Username: username, 
                        Password: password, 
                        Email: email, 
                        CardNumber: cardNumber, 
                        RoleId: roleId 
                    })
                });

                if (!response.ok) {
                    throw new Error("L·ªói k·∫øt n·ªëi ƒë·∫øn server");
                }

                const result = await response.json();
                document.getElementById("message").textContent = result.message || result.error;
            } catch (error) {
                console.error("L·ªói:", error);
                document.getElementById("message").textContent = "Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server!";
            }
        });
    </script>
</body>
</html>
